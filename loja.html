<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>🏰 Loja - Divina Opção</title>

  <style>
    body {
      background: url('imagem/bg_taverna.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'MedievalSharp', cursive;
      color: #fdf6e3;
      margin: 0; padding: 0;
    }
    header { background: rgba(44,27,13,0.9); padding:20px; text-align:center; border-bottom:3px solid #d4af37; }
    header h1 { font-size:2.5rem; margin:0; }
    main { padding:20px; background:rgba(0,0,0,0.6); min-height:80vh; }
    .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:20px; }
    .item { background:#362c1a; border:2px solid #d4af37; border-radius:10px; padding:15px; text-align:center; box-shadow:0 0 10px #000; transition:transform .2s; }
    .item:hover { transform:scale(1.05); }
    .item p, .item h3 { margin:5px 0; }
    .item button { background:#d4af37; border:none; color:#000; padding:8px 12px; border-radius:6px; cursor:pointer; }
    .item button:disabled { opacity:.5; cursor:not-allowed; }
    .botao {
      display:block; width:fit-content; margin:10px auto;
      background:#6b4226; color:#fff; padding:10px 20px;
      text-decoration:none; border:2px solid #d4af37; border-radius:8px;
    }
  </style>
</head>
<body>

  <header>
    <h1>🏰 Loja da Divina Opção</h1>
    <p>Escolha seus itens para a jornada.</p>
  </header>

  <main>
    <h2>💰 Seu Ouro: <span id="moedas">0</span> PO</h2>
    <div id="itens-loja" class="grid"></div>
    <a href="inventario.html" class="botao">📦 Ir para Inventário</a>
    <a href="index.html" class="botao">🏠 Voltar ao Início</a>
  </main>

  <script>
  (function(){
    function load(key, def){ try{ return JSON.parse(localStorage.getItem(key))||def }catch{return def} }
    function save(key,val){ localStorage.setItem(key,JSON.stringify(val)); }

    let moedas = load('moedas',100);
    let inventario = load('inventario',[]);
    let estoque = load('estoque',[
      { id:'adaga', nome:'Adaga', preco:15, arquivo:'adaga.html', qt:5 },
      { id:'escudo', nome:'Escudo', preco:25, arquivo:'escudo.html', qt:3 },
      { id:'pocao_verde', nome:'Poção Verde', preco:10, arquivo:'pocao_verde.html', qt:10 },
      { id:'espada_curta', nome:'Espada Curta', preco:20, arquivo:'espada_curta.html', qt:4 },
      { id:'armadura_couro', nome:'Armadura de Couro', preco:30, arquivo:'armadura_couro.html', qt:2 },
      { id:'cajado_basico', nome:'Cajado Básico', preco:18, arquivo:'cajado_basico.html', qt:3 },
      { id:'arco_simples', nome:'Arco Simples', preco:22, arquivo:'arco_simples.html', qt:3 },
      { id:'bota_rapida', nome:'Botas de Agilidade', preco:12, arquivo:'bota_rapida.html', qt:5 },
      { id:'anel_protecao', nome:'Anel de Proteção', preco:40, arquivo:'anel_protecao.html', qt:2 },
      { id:'capa_furtiva', nome:'Capa Furtiva', preco:25, arquivo:'capa_furtiva.html', qt:3 },
      { id:'livro_magias', nome:'Livro de Magias', preco:35, arquivo:'livro_magias.html', qt:2 },
      { id:'poção_cura', nome:'Poção de Cura', preco:10, arquivo:'pocao_cura.html', qt:8 },
      { id:'lanterna', nome:'Lanterna Rústica', preco:8, arquivo:'lanterna.html', qt:6 },
      { id:'machado_leve', nome:'Machado Leve', preco:19, arquivo:'machado_leve.html', qt:4 },
      { id:'amuletovida', nome:'Amuleto da Vida', preco:50, arquivo:'amuletovida.html', qt:1 },
      { id:'cinto_forca', nome:'Cinto de Força', preco:28, arquivo:'cinto_forca.html', qt:2 }
    ]);

    const mon = document.getElementById('moedas');
    const loja = document.getElementById('itens-loja');
    mon.textContent = moedas;

    function renderLoja(){
      loja.innerHTML = '';
      estoque.forEach(item=>{
        const d=document.createElement('div'); d.className='item';
        d.innerHTML=`
          <h3>${item.nome}</h3>
          <p>Preço: <strong>${item.preco} PO</strong></p>
          <p>Em estoque: <strong>${item.qt}</strong></p>
          <button ${item.qt===0?'disabled':''} data-id="${item.id}">🛒 Comprar</button>
        `;
        d.querySelector('button').onclick=()=>comprar(item.id);
        loja.appendChild(d);
      });
    }

    function comprar(id){
      const it=estoque.find(x=>x.id===id);
      if(!it||it.qt===0||moedas<it.preco)return alert('Não é possível comprar.');
      moedas-=it.preco; it.qt--;
      inventario.push({ nome:it.nome, precoVenda:Math.floor(it.preco/2) });
      save('moedas',moedas);
      save('estoque',estoque);
      save('inventario',inventario);
      mon.textContent=moedas;
      renderLoja();
      alert(`Você comprou ${it.nome} por ${it.preco} PO!`);
    }

    renderLoja();
  })();
  </script>

</body>
</html>
